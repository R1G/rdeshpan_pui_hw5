<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Muddy Paws Adventure Gear</title>
    <meta name="author" content="Rigved Deshpande">

    <link rel="stylesheet" href="styles.css">

  </head>

  <body>
    <!-- logo -->
    <a href="index.html" class="logo" id="small-logo">
      <h1>Muddy Paws</h1>
      <h2>Adventure Gear</h2>
    </a>

    <a href="products.html" class="escape">Back to browse</a>

    <div class="purchase-options">
      <!-- product image-->
      <div class="column product-view">
        <!--h1>Dog Harness</h1-->
        <!--img class="product-image" src="Images/dog_harness.jpg" alt="dog harness"/-->
      </div>

      <!-- sizes-->
      <div class="column size-boxes">
        <div data-size="Tiny" class="box">XS</div>
        <div data-size="Small" class="box">S</div>
        <div data-size="Medium" class="box">M</div>
        <div data-size="Large" class="box">L</div>
      </div>

      <!-- colors-->
      <div class="column color-boxes">
        <div data-color="Strawberry" class="box" style="background-color:red;">Strawberry</div>
        <div data-color="Blackberry" class="box" style="background-color:rebeccapurple;">Blackberry</div>
        <div data-color="Crazyberry" class="box" style="background-color:hotpink;">Crazyberry</div>
        <div data-color="Fireberry" class="box" style="background-color:orange;">Fireberry</div>
      </div>

      <div class="column">
        <div class="pricing">
          <!--h1>$34.99</h1-->
        </div>

        <div class="button green right" id="add-to-cart">Add to Cart</div>
        <a href="checkout.html" class="button orange right" id="view-cart">View Cart</a>

      </div>
      
    </div>
    <script>

    (function() {
        const addToCart = document.querySelector("#add-to-cart");
        const viewCart = document.querySelector("#view-cart");
        //LOADING PRODUCT SELECTION
        const productViewContainer = document.querySelector('.product-view');
        const selectedProduct = localStorage.getItem('selectedProduct');
        const productName = selectedProduct.replace('_',' ');

        productViewContainer.insertAdjacentHTML('beforeend', `<h1>${productName}</h1>`);
        var imagePath = "Images/" + selectedProduct + ".jpg";
        productViewContainer.insertAdjacentHTML('beforeend', `<img class="product-image" src=${imagePath}>`);
        viewCart.innerHTML = `View Cart (${localStorage.getItem("cartSize")})`;

        //SIZE SELECTION
        const sizesContainer = document.querySelector('.size-boxes');
        let selectedSizeBox;

        const selectedSize = localStorage.getItem('selectedSize');
        console.log(selectedSize);

        if (selectedSize) {
          selectedSizeBox = document.querySelector(`[data-size=${selectedSize}]`);
          if(selectedSizeBox)
            selectedSizeBox.classList.add('selected-size');
        }

        sizesContainer.addEventListener('click', function (event) {
            if (selectedSizeBox) {
                selectedSizeBox.classList.remove('selected-size');
            }
            selectedSizeBox = event.target;
            selectedSizeBox.classList.add('selected-size');
            localStorage.setItem('selectedSize', event.target.getAttribute('data-size'));
        });

        //COLOR SELECTION
        const colorsContainer = document.querySelector('.color-boxes');
        let selectedColorBox;

        const selectedColor = localStorage.getItem('selectedColor');

        if (selectedColor) {
          selectedColorBox = document.querySelector(`[data-color=${selectedColor}]`);
          if(selectedColorBox)
            selectedColorBox.classList.add('selected-color');
        }

        colorsContainer.addEventListener('click', function (event) {
            if (selectedColorBox) {
                selectedColorBox.classList.remove('selected-color');
            }
            selectedColorBox = event.target;
            selectedColorBox.classList.add('selected-color');
            localStorage.setItem('selectedColor', event.target.getAttribute('data-color'));
        });

        //FINAL PURCHASE
        addToCart.addEventListener('click', function() {
            if(selectedSizeBox && selectedColorBox) {
              let cartSize = parseInt(localStorage.getItem("cartSize"));
              if(addToCart.innerHTML == "Added") {
                addToCart.innerHTML = "Add to Cart";
                cartSize-=1;
                localStorage.setItem("cartSize",cartSize);
              } else {
                addToCart.innerHTML = "Added";
                cartSize+=1;
                localStorage.setItem("cartSize",cartSize);
              }
              viewCart.innerHTML = `View Cart (${localStorage.getItem("cartSize")})`;
            }
        });
    }());

    </script>
  </body>
</html>